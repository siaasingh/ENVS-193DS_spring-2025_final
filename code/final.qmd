---
title: "ENVS 193DS Final Project: [Your Project Title Here]"
author: "Siaa Singh"
date: "06/10/2025"
format: html
---
```{r}
# Load required libraries
library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)

# Read in the SST dataset
sst <- read_csv("../data/SST_update2023.csv")
```

Problem 1 
a. a. Transparent Statistical Methods
Part 1: The author used a correlation test, likely Pearson’s correlation, to evaluate the 
relationship between distance from the headwater and total nitrogen load. This is implied by the phrasing “correlation” and the numeric p-value. The author used an Analysis of Variance (ANOVA) to 
compare the mean nitrogen loads between different sources (urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands), as indicated by the reference to 
“average nitrogen load” and the overall p-value for group differences.

b. Including means and standard deviations for nitrogen load by each source category would give readers a clearer picture of how nitrogen contributions differ across land use types.Providing the number of observations per nitrogen source would help readers understand the reliability of the ANOVA results. For example, if one group had a very small sample size, its contribution to the test outcome might be questionable.

c. Nitrogen load increased with distance from the headwater, suggesting a spatial accumulation effect along the river. A correlation test was used to assess this relationship 
(test: Pearson’s correlation; r = [correlation coefficient], p = 0.03, α = 0.05).
There were statistically significant differences in nitrogen load among the five source categories, suggesting that some sources contribute disproportionately to nitrogen levels in the delta. 
An ANOVA was used to compare group means (test: ANOVA; F = [test statistic], df = 
[degrees of freedom], p = 0.02, α = 0.05).


2 a. 

```{r}
# Load required libraries
library(tidyverse)
library(lubridate)

#  Read in the SST data
sst <- read_csv("../data/SST_update2023.csv")

# Clean and summarize the SST data
sst_clean <- sst %>%
  # Extract year and month from the date column
  mutate(
    year = year(date),
    month = month(date, label = TRUE, abbr = TRUE)
  ) %>%
  # Group by year and month to calculate monthly means
  group_by(year, month) %>%
  summarise(
    mean_monthly_sst = mean(temp, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  # Filter for years 2018 to 2023
  filter(year %in% 2018:2023)

# View a random sample of 5 rows
slice_sample(sst_clean, n = 5)

# Display the structure of the cleaned data
str(sst_clean)

```

2. b 
```{r}
# Filter data for the years of interest
sst_filtered <- sst_clean %>%
  filter(year %in% 2018:2023)

# Create the plot
ggplot(sst_filtered, aes(x = month, y = mean_monthly_sst, group
                         = year, color = year)) +
  # Add lines for each year
  geom_line(size = 1) +
  # Add points for each month
  geom_point(size = 2) +
  # Use a gradient scale: light to dark
  scale_color_gradient(low = "lightblue", high = "navy") +
  # Label the axes
  labs(
    x = "Month",
    y = "Mean monthly sea surface temperature (°C)",
    color = "Year"
  ) +
  # Put legend inside the plot
  theme(
    legend.position = c(0.15, 0.75),  
    # top left-ish
    legend.background = element_rect(fill = "white", color = "black"),
    panel.background = element_blank(),
    panel.border = element_rect(color = "black", fill = NA)
  )

```

Problem 3. 

```{r}
# Load required libraries
library(tidyverse)  # For data wrangling and ggplot
library(DHARMa)     # For checking model diagnostics
library(MuMIn)      # For AIC model comparison
library(broom)      # For tidying model output (optional but useful)

```

```{r}
nest <- read_csv("../data/occdist.csv")
```

a. In this dataset, the "sp" variable represents Swift Parrot occupancy.
1 indicates that the parrot used a nest box during the season. The value of 
0 indicates that a box was not used/occupied. 

b. The main distinction is that the nest box intervention's main conservation goal is 
for Swift Parrots, a species that is critically endangered. 
Swift Parrot availability may be lowered by non-target or competing species 
like Common Starlings and Tree Martins, which may also inhabit nest boxes.

c. Nest box occupancy was measured in 2016 and 2019, which are referred to as the two "seasons" in this study. Researchers can determine whether temporal variation influences nest box use by comparing the environmental conditions and Swift Parrot occupancy levels in these years.

d. 
```{r}
# Model table for Problem 3d
library(tibble)

model_table <- tibble::tibble(
  `Model #` = c(1, 2, 3, 4),
  `Season Included` = c("No", "Yes", "Yes", "No"),
  `Distance to Edge Included` = c("No", "Yes", "No", "Yes"),
  `Model Description` = c(
    "Null model — assumes constant occupancy",
    "Saturated model — includes both season and distance",
    "Season-only model",
    "Distance-only model"
  )
)

# View the model table
model_table

```

e. 
```{r}
# Run all logistic regression models for Swift Parrot occupancy

# Null model – no predictors
model1 <- glm(sp ~ 1, data = nest, family = binomial)

# Saturated model – includes both season and distance
model2 <- glm(sp ~ season + `edge distance`, data = nest, family = binomial)

# Season-only model
model3 <- glm(sp ~ season, data = nest, family = binomial)

# Distance-only model
model4 <- glm(sp ~ `edge distance`, data = nest, family = binomial)

```

3f 
```{r}
# Load DHARMa (only if not already loaded)
library(DHARMa)

# Simulate residuals for each model
sim1 <- simulateResiduals(model1)
sim2 <- simulateResiduals(model2)
sim3 <- simulateResiduals(model3)
sim4 <- simulateResiduals(model4)

# Plot residuals for each model
plot(sim1, main = "Model 1: Null Model")
plot(sim2, main = "Model 2: Saturated Model")
plot(sim3, main = "Model 3: Season-only Model")
plot(sim4, main = "Model 4: Distance-only Model")

```


